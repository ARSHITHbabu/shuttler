<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Academy Schedule - Owner</title>
    <link rel="stylesheet" href="owner-styles.css">
</head>
<body>
    <div class="container">
        <div class="nav">
            <a href="owner-dashboard.html" >ğŸ“Š Dashboard</a>
            <a href="owner.html" >ğŸ‘¨â€ğŸ« Coaches</a>
            <a href="owner-batches.html" >ğŸ“š Batches</a>
            <a href="owner-students.html" >ğŸ“ Students</a>
            <a href="owner-attendance.html" >ğŸ“‹ Attendance</a>
            <a href="owner-coach-attendance.html" >ğŸ‘” Coach Attendance</a>
            <a href="owner-fees.html" >ğŸ’° Fees</a>
            <a href="owner-performance.html" >â­ Performance</a>
            <a href="owner-bmi.html" >ğŸ“ BMI</a>
            <a href="owner-schedule.html" class="active">ğŸ“… Schedule</a>
            <a href="owner-enquiries.html" >ğŸ“ Enquiries</a>
            <a href="owner-analytics.html" >ğŸ“ˆ Analytics</a>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>
        <h1>ğŸ“… Academy Schedule</h1>
        <div id="scheduleContainer"></div>
    </div>
    <script>
        const API_URL = 'http://localhost:8000';
        loadSchedule();
        async function loadSchedule() {
            try {
                const [batchesRes, coachesRes] = await Promise.all([
                    fetch(`${API_URL}/batches/`),
                    fetch(`${API_URL}/coaches/`)
                ]);
                const batches = await batchesRes.json();
                const coaches = await coachesRes.json();
                const container = document.getElementById('scheduleContainer');
                if (batches.length === 0) {
                    container.innerHTML = '<div style="text-align:center;padding:60px;color:#999;">No batches created yet</div>';
                    return;
                }
                const coachMap = {};
                coaches.forEach(c => coachMap[c.id] = c.name);
                const morningBatches = batches.filter(b => b.period === 'Morning');
                const eveningBatches = batches.filter(b => b.period === 'Evening');
                container.innerHTML = `
                    <h2 style="margin-top: 20px;">ğŸŒ… Morning Batches (${morningBatches.length})</h2>
                    <div class="batches-grid">
                        ${morningBatches.map(batch => `
                            <div class="batch-card">
                                <div class="batch-name">${batch.batch_name}</div>
                                <div class="batch-info">
                                    <div>ğŸ‘¨â€ğŸ« <strong>Coach:</strong> ${coachMap[batch.assigned_coach_id] || 'Not Assigned'}</div>
                                    <div>â° <strong>Timing:</strong> ${batch.timing}</div>
                                    <div>ğŸ“ <strong>Location:</strong> ${batch.location || 'N/A'}</div>
                                    <div>ğŸ’° <strong>Fees:</strong> ${batch.fees}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <h2 style="margin-top: 40px;">ğŸŒ† Evening Batches (${eveningBatches.length})</h2>
                    <div class="batches-grid">
                        ${eveningBatches.map(batch => `
                            <div class="batch-card">
                                <div class="batch-name">${batch.batch_name}</div>
                                <div class="batch-info">
                                    <div>ğŸ‘¨â€ğŸ« <strong>Coach:</strong> ${coachMap[batch.assigned_coach_id] || 'Not Assigned'}</div>
                                    <div>â° <strong>Timing:</strong> ${batch.timing}</div>
                                    <div>ğŸ“ <strong>Location:</strong> ${batch.location || 'N/A'}</div>
                                    <div>ğŸ’° <strong>Fees:</strong> ${batch.fees}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
            } catch (error) { console.error('Error loading schedule:', error); }
        }
        function logout() { window.location.href = 'owner.html'; }
        setInterval(loadSchedule, 30000);
    </script>
</body>
</html>
